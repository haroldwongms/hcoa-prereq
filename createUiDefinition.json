{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [{
    }],
    "steps": [{
      "name": "infrastructureSettings",
      "label": "Infrastructure Settings",
      "subLabel": {
        "preValidation": "Configure Infrastructure Settings",
        "postValidation": "Done"
      },
      "bladeTitle": "Horizon Cloud on Azure Prerequisites",
      "elements": [{
        "name": "virtualNetwork",
        "type": "Microsoft.Network.VirtualNetworkCombo",
        "label": {
          "virtualNetwork": "Virtual network",
          "subnets": "Subnets"
        },
        "defaultValue": {
          "name": "vnet01",
          "addressPrefixSize": "/16"
        },
        "toolTip": {
          "virtualNetwork": "",
          "subnets": ""
        },
        "constraints": {
          "minAddressPrefixSize": "/16"
        },
        "options": {
          "hideExisting": true
        },
        "subnets": {
          "managementSubnet": {
            "label": "Create management subnet - This /27 subnet is for IP addresses needed by the management pod",
            "defaultValue": {
              "name": "managementSubnet",
              "addressPrefixSize": "/27"
            },
            "constraints": {
              "minAddressPrefixSize": "/27",
              "minAddressCount": 12,
              "requireContiguousAddresses": true
            }
          },
          "desktopSubnet": {
            "label": "Create primary desktop or tenant subnet - This /27 or more subnet is for the desktops or RDSH/multisession servers.",
            "defaultValue": {
              "name": "desktopSubnet",
              "addressPrefixSize": "/26"
            },
            "constraints": {
              "minAddressPrefixSize": "/26",
              "minAddressCount": 8,
              "requireContiguousAddresses": true
            }
         },
          "DMZSubnet": {
            "label": "Create front-end DMZ subnet - This /28 or more subnet is for the Unified Access Gateway to communicate with the external gateway's load balancer.",
            "defaultValue": {
              "name": "DMZSubnet",
              "addressPrefixSize": "/28"
            },
            "constraints": {
              "minAddressPrefixSize": "/28",
              "minAddressCount": 8,
              "requireContiguousAddresses": true
            }
          }
        },
        "visible": true
        }]
    }],
    "outputs": {
      "vmAnsibleTowerUsername": "[basics('vmAnsibleTowerUsername')]",
      "sshKeyData": "[basics('adminPassword').sshPublicKey]",
      "vmSize": "[steps('infrastructureSettings').vmSize]",
      "vmTowerName": "[steps('infrastructureSettings').vmTowerName]",
      "ansibleTowerAdminPassword": "[steps('ansibleTowerSettings').ansibleTowerAdminPassword]",
      "ansibleTowerDatabasePassword": "[steps('ansibleTowerSettings').ansibleTowerDatabasePassword]"
    }
  }
}
